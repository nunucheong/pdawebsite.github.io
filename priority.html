<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>

</head>
<body>

<script>

function getCheckedBoxes(chkboxName) {	//function to collect all ticked checkboxes
  var checkboxes = document.getElementsByName(chkboxName);
  var displayChecked = "<br/><h1><b><center>Concerns</center></b></h1>";
  var x="";
  if(checkboxes[0].checked){
  x = document.getElementById("knowledge").value;
  }
  for (var i=0; i<checkboxes.length; i++) {
     if (checkboxes[i].checked) {

        displayChecked += "<br/><label><input type='checkbox' checked disabled>->"+checkboxes[i].value+"</label>";

        if(checkboxes[0].checked){
     		displayChecked += " "+x;
     		x = "";
        }
     }
  }
  return displayChecked;
}
	var treatmentGoalsIssues = ["Chance of survival","Curing the cancer","Curing any symptoms I may have","Having the best possible sexual performance","Having a good bowel and bladder control","Cost of treatment"];	//used to concatenate data

	function retrieveGoals(patientTreatmentGoals){	//generate table based on user selection
var tick = "&#9745";
var untick = "&#9744";
		var createTable = "<div id='goalsOutput'><br/><h1><b><center>Treatment Goals</center></b></h1><table id='tab_customers' class='table table-striped'><colgroup><col width='20%'><col width='20%'></colgroup><thead><tr class='warning'><th>Treatment Goals</th><th>Importance</th></tr></thead><tbody>";
		for(i=0;i<6;i++){
			var data = document.forms["patientTreatmentGoals"]["treatmentGoals["+i+"]"].value;
			if(data == "1")
				data = "Not very important";
			else if(data == "2")
				data = "Important";
			else if(data == "3")
				data = "Very important";
			else
				data = "Unanswered";
			createTable += "<tr><td>"+treatmentGoalsIssues[i]+"</td><td>"+data+"</td></tr>";
		}
		createTable += "</tbody></table>"+getCheckedBoxes("concerns[]")+"</div><button onclick='javascript:generatePDF();'>Create PDF</button>";
		// createTable += "<p>&#9744; huhuhuu</p><p>&#9745; testtttt</p>";
		document.getElementById("outputLocation").innerHTML = createTable;
		}

		function addSupport(checkbox){	//function utk add checkbox

		var expand = "&ensp;<label><input type='checkbox' name='concerns[]' value='->   Family support'>Family support</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='->   Financial support'>Financial support</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='->   Spiritual support'>Spiritual support</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='->   Support from doctors'>Support from doctors</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='->   Peers/ support group'>Peers/ support group</label><br/>";

		if(checkbox.checked){
			document.getElementById("expandSupport").innerHTML = expand;
		}
		else{
			document.getElementById("expandSupport").innerHTML = "";
		}
	}

	function addKnowledge(checkbox){	//function utk add input text
		var expand = "<input type='text' name='knowledge' id='knowledge'/>";
		if(checkbox.checked){
			document.getElementById("expandKnowledge").innerHTML = expand;
		}else{
			document.getElementById("expandKnowledge").innerHTML = "";
		}
	}

	function generatePDF() {	//function utk generate PDF,process the div tag

    var pdf = new jsPDF('p', 'pt', 'letter');
    source = $('#goalsOutput')[0];
    specialElementHandlers = {
        '#bypassme': function (element, renderer) {
            return true
        }
    };
    margins = {
        top: 150,
        bottom: 60,
        left: 40,
        width: 522
    };
    pdf.fromHTML(
    source, // HTML string or DOM elem ref.
    margins.left, // x coord
    margins.top, { // y coord
        'width': margins.width, // max width of content on PDF
        'elementHandlers': specialElementHandlers
        },

    function (dispose) {
        pdf.save('Priority.pdf');
        }, margins);
    }

</script>
<div id="outputLocation">
<form id="patientTreatmentGoals" name ="patientTreatmentGoals">
	<table>
	<thead>
		<tr>
			<th>Goals</th>
			<th>Not very important</th>
			<th>Important</th>
			<th>Very important</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Chance of survival</td>
			<td><input type="radio" name="treatmentGoals[0]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[0]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[0]" value="3"/></td>
		</tr>
		<tr>
			<td>Curing the cancer</td>
			<td><input type="radio" name="treatmentGoals[1]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[1]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[1]" value="3"/></td>
		</tr>
		<tr>
			<td>Curing any symptoms I may have</td>
			<td><input type="radio" name="treatmentGoals[2]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[2]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[2]" value="3"/></td>
		</tr>
		<tr>
			<td>Having the best possible sexual performance</td>
			<td><input type="radio" name="treatmentGoals[3]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[3]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[3]" value="3"/></td>
		</tr>
		<tr>
			<td>Having a good bowel and bladder control</td>
			<td><input type="radio" name="treatmentGoals[4]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[4]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[4]" value="3"/></td>
		</tr>
		<tr>
			<td>Cost of treatment</td>
			<td><input type="radio" name="treatmentGoals[5]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[5]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[5]" value="3"/></td>
		</tr>
	</tbody>
	</table>
	
</form>


<form id="patientConcerns" name="patientConcerns" onsubmit="return retrieveConcerns();">
<label><input type="checkbox" name="concerns[]" onchange='addKnowledge(this);' value="I dont have enough information to make a choice.I want to know more about ... ">I dont have enough information to make a choice.I want to know more about ... </label><br/>
<div id="expandKnowledge"></div>
<label><input type="checkbox" name="concerns[]" value="I am concerned about the treatment cost.">I am concerned about the treatment cost.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know about how treatment will affect my lifestyle.">I want to know about how treatment will affect my lifestyle.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know about how treatment will affect my work.">I want to know about how treatment will affect my work.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I have religious concerns about the treatment.">I have religious concerns about the treatment.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know more about survival.">I want to know more about survival.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know more about the experiences of other people with prostate cancer.">I want to know more about the experiences of other people with prostate cancer.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know more about diet during treatment.">I want to know more about diet during treatment.</label><br/>
<label><input type="checkbox" name="concerns[]" onchange='addSupport(this);' value="I need more support in making a decision. I want more:">I need more support in making a decision. I want more :</label><br/>
<div id="expandSupport"></div>
<label><input type="checkbox" name="concerns[]" value="I am distressed (e.g. shocked, confused, angry, panicked)">I am distressed (e.g. shocked, confused, angry, panicked)</label><br/>
</form>
<h1 onclick="javascript:retrieveGoals(patientTreatmentGoals);">Submit</h1>
</div>
</body>
</html>
