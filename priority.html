<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>

</head>
<body>
<script>

function getCheckedBoxes(chkboxName) {
  var checkboxes = document.getElementsByName(chkboxName);
  var checkboxesChecked = [];
  // loop over them all
  for (var i=0; i<checkboxes.length; i++) {
     // And stick the checked ones onto an array...
     if (checkboxes[i].checked) {
        checkboxesChecked.push(checkboxes[i].value);
        alert(checkboxes[i].value);
     }
  }
  // Return the array if it is non-empty, or null
  return checkboxesChecked.length > 0 ? checkboxesChecked : null;
}



	var treatmentGoalsIssues = ["Chance of survival","Curing the cancer","Curing any symptoms I may have","Having the best possible sexual performance","Having a good bowel and bladder control","Cost of treatment"];

	function retrieveGoals(patientTreatmentGoals){

		var createTable = "<div id='goalsOutput'><table id='tab_customers' class='table table-striped'><colgroup><col width='20%'><col width='20%'></colgroup><thead><tr class='warning'><th>Treatment Goals</th><th>Importance</th></tr></thead><tbody>";
		for(i=0;i<6;i++){
			var data = document.forms["patientTreatmentGoals"]["treatmentGoals["+i+"]"].value;
			if(data == "1")
				data = "Not very important";
			else if(data == "2")
				data = "Important";
			else if(data == "3")
				data = "Very important";
			else
				data = "Unanswered";
			createTable += "<tr><td>"+treatmentGoalsIssues[i]+"</td><td>"+data+"</td></tr>";
		}
		createTable += "</tbody></table></div><button onclick='javascript:demoFromHTML();'>PDF</button>";
		// createTable += "<p>&#9744; huhuhuu</p><p>&#9745; testtttt</p>";
		document.getElementById("outputLocation").innerHTML = createTable;

		var tick = "&#9745";
		var untick = "&#9744";
		}
</script>
<div id="outputLocation"><center>
<form id="patientTreatmentGoals" name ="patientTreatmentGoals">
	<table>
	<thead>
		<tr>
			<th>Goals</th>
			<th>Not very important</th>
			<th>Important</th>
			<th>Very important</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Chance of survival</td>
			<td><input type="radio" name="treatmentGoals[0]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[0]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[0]" value="3"/></td>
		</tr>
		<tr>
			<td>Curing the cancer</td>
			<td><input type="radio" name="treatmentGoals[1]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[1]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[1]" value="3"/></td>
		</tr>
		<tr>
			<td>Curing any symptoms I may have</td>
			<td><input type="radio" name="treatmentGoals[2]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[2]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[2]" value="3"/></td>
		</tr>
		<tr>
			<td>Having the best possible sexual performance</td>
			<td><input type="radio" name="treatmentGoals[3]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[3]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[3]" value="3"/></td>
		</tr>
		<tr>
			<td>Having a good bowel and bladder control</td>
			<td><input type="radio" name="treatmentGoals[4]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[4]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[4]" value="3"/></td>
		</tr>
		<tr>
			<td>Cost of treatment</td>
			<td><input type="radio" name="treatmentGoals[5]" value="1" required/></td>
			<td><input type="radio" name="treatmentGoals[5]" value="2" checked/></td>
			<td><input type="radio" name="treatmentGoals[5]" value="3"/></td>
		</tr>
	</tbody>
	</table>
	<h1 onclick="javascript:retrieveGoals(patientTreatmentGoals);">Retrieve Goalllsss</h1>
</form></center>
</div>

<form id="patientConcerns" name="patientConcerns" onsubmit="return retrieveConcerns();">
<label><input type="checkbox" name="concerns[]" onchange='addKnowledge(this);' value="I dont have enough information to make a choice.I want to know more about ... ">I dont have enough information to make a choice.I want to know more about ... </label><br/>
<div id="expandKnowledge"></div>
<label><input type="checkbox" name="concerns[]" value="I am concerned about the treatment cost.">I am concerned about the treatment cost.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know about how treatment will affect my lifestyle.">I want to know about how treatment will affect my lifestyle.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know about how treatment will affect my work.">I want to know about how treatment will affect my work.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I have religious concerns about the treatment.">I have religious concerns about the treatment.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know more about survival.">I want to know more about survival.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know more about the experiences of other people with prostate cancer.">I want to know more about the experiences of other people with prostate cancer.</label><br/>
<label><input type="checkbox" name="concerns[]" value="I want to know more about diet during treatment.">I want to know more about diet during treatment.</label><br/>
<label><input type="checkbox" name="concerns[]" onchange='addSupport(this);' value="I need more support in making a decision. I want more:">I need more support in making a decision. I want more :</label><br/>
<div id="expandSupport"></div>
<label><input type="checkbox" name="concerns[]" value="I am distressed (e.g. shocked, confused, angry, panicked)">I am distressed (e.g. shocked, confused, angry, panicked)</label><br/>
	<h1 onclick="return retrieveConcerns();">Retrieve Concerns</h1>
	<h1 onclick="return checkCheckbox();">Check Checkbox</h1>
</form>

<script>

	function addSupport(checkbox){

		var expand = "&ensp;<label><input type='checkbox' name='concerns[]' value='Family support'>Family support</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='Financial support'>Financial support</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='Spiritual support'>Spiritual support</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='Support from doctors'>Support from doctors</label><br/>&ensp;<label><input type='checkbox' name='concerns[]' value='Peers/ support group'>Peers/ support group</label><br/>";

		if(checkbox.checked){
			document.getElementById("expandSupport").innerHTML = expand;
		}
		else{
			document.getElementById("expandSupport").innerHTML = "";
		}
	}

	function addKnowledge(checkbox){
		var expand = "<input type='text' name='knowledge'/>";

		if(checkbox.checked){
			document.getElementById("expandKnowledge").innerHTML = expand;
		}else{
			document.getElementById("expandKnowledge").innerHTML = "";
		}
	}

	function checkCheckbox(patientConcerns){
		// var form = document.form['patientConcerns'];
		var checkedBoxes = getCheckedBoxes("concerns[]");
		alert(checkedBoxes+"huhu");
	}

	function demoFromHTML() {

    var pdf = new jsPDF('p', 'pt', 'letter');


    // source can be HTML-formatted string, or a reference
    // to an actual DOM element from which the text will be scraped.
    source = $('#goalsOutput')[0];

    // we support special element handlers. Register them with jQuery-style 
    // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
    // There is no support for any other type of selectors 
    // (class, of compound) at this time.
    specialElementHandlers = {
        // element with id of "bypass" - jQuery style selector
        '#bypassme': function (element, renderer) {
            // true = "handled elsewhere, bypass text extraction"
            return true
        }
    };
    margins = {
        top: 150,
        bottom: 60,
        left: 40,
        width: 522
    };
    // all coords and widths are in jsPDF instance's declared units
    // 'inches' in this case
    pdf.fromHTML(
    source, // HTML string or DOM elem ref.
    margins.left, // x coord
    margins.top, { // y coord
        'width': margins.width, // max width of content on PDF
        'elementHandlers': specialElementHandlers
        },

    function (dispose) {
        // dispose: object with X, Y of the last line add to the PDF 
        //          this allow the insertion of new lines after html
        // pdf.text(35, 25, "testing"+&#9745);
        pdf.save('Test.pdf');
        }, margins);
    }

</script>
</body>
</html>
